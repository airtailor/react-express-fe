window.$P=function(){};var lpMTagConfig={lpTagLoaded:false,lpTagSrv:"storechat.apple.com",pageStartTime:(new Date()).getTime(),deploymentID:"1",sendCookies:false};lpMTagConfig.deploymentConfigPath=lpMTagConfig.lpTagSrv+"/visitor/addons/deploy.asp";lpMTagConfig.lpLoadScripts=function(){lpAddMonitorTag(lpMTagConfig.lpProtocol+"://"+lpMTagConfig.deploymentConfigPath+"?site="+lpMTagConfig.lpNumber+"&d_id="+lpMTagConfig.deploymentID)};function lpAddMonitorTag(b){if(!lpMTagConfig.lpTagLoaded){if(typeof(b)=="undefined"||typeof(b)=="object"){if(lpMTagConfig.lpMTagSrc){b=lpMTagConfig.lpMTagSrc}else{if(lpMTagConfig.lpTagSrv){b=lpMTagConfig.lpProtocol+"://"+lpMTagConfig.lpTagSrv+"/hcp/html/mTag.js"}else{b="/hcp/html/mTag.js"}}}if(b.indexOf("http")!==0){b=lpMTagConfig.lpProtocol+"://"+lpMTagConfig.lpServer+b+"?site="+lpMTagConfig.lpNumber}else{if(b.indexOf("site=")<0){if(b.indexOf("?")<0){b=b+"?"}else{b=b+"&"}b=b+"site="+lpMTagConfig.lpNumber}}var a=document.createElement("script");a.setAttribute("type","text/javascript");a.setAttribute("charset","iso-8859-1");a.setAttribute("src",b);document.getElementsByTagName("head").item(0).appendChild(a)}}lpMTagConfig.calculateSentPageTime=function(){var a=(new Date()).getTime()-lpMTagConfig.pageStartTime;lpAddVars("page","pageLoadTime",Math.round(a/1000)+" sec")};if(typeof(lpMTagConfig.pageVar)=="undefined"){lpMTagConfig.pageVar=[]}if(typeof(lpMTagConfig.sessionVar)=="undefined"){lpMTagConfig.sessionVar=[]}if(typeof(lpMTagConfig.visitorVar)=="undefined"){lpMTagConfig.visitorVar=[]}if(typeof(lpMTagConfig.onLoadCode)=="undefined"){lpMTagConfig.onLoadCode=[]}if(typeof(lpMTagConfig.dynButton)=="undefined"){lpMTagConfig.dynButton=[]}if(typeof(lpMTagConfig.ifVisitorCode)=="undefined"){lpMTagConfig.ifVisitorCode=[]}function lpAddVars(b,a,c){if(a.indexOf("OrderTotal")!==-1||a.indexOf("OrderNumber")!==-1){if(c===""||c===0){return}else{lpMTagConfig.sendCookies=false}}c=lpTrimSpaces(c.toString());if(a.length>50){a=a.substr(0,50)}if(c.length>50){c=c.substr(0,50)}switch(b){case"page":lpMTagConfig.pageVar[lpMTagConfig.pageVar.length]=escape(a)+"="+escape(c);break;case"session":lpMTagConfig.sessionVar[lpMTagConfig.sessionVar.length]=escape(a)+"="+escape(c);break;case"visitor":lpMTagConfig.visitorVar[lpMTagConfig.visitorVar.length]=escape(a)+"="+escape(c);break;default:break}}function onloadEMT(){var b=document.cookie,a=window.lpMTag;if(a.lpBrowser=="IE"&&b.length>1000){lpMTagConfig.sendCookies=false}}function lpTrimSpaces(a){return a.replace(/^\s+|\s+$/g,"")}function lpSendData(c,b,d){var a=window.lpMTag;if(typeof(a)!="undefined"&&typeof(a.lpSendData)!="undefined"){a.lpSendData(c.toUpperCase()+"VAR!"+b+"="+d,true)}}try{if(typeof(lpCountryCode)=="undefined"){lpCountryCode="us"}if(typeof(lpAddVars)!="undefined"){lpAddVars("page","lpCountryCode",lpCountryCode)}if(typeof(lpSegment)=="undefined"){lpSegment="consumer"}if(typeof(lpAddVars)!="undefined"){lpAddVars("page","lpSegment",lpSegment)}if(typeof(lpUnit)=="undefined"){lpUnit="sales"}if(typeof(lpAddVars)!="undefined"){lpAddVars("page","lpUnit",lpUnit)}if(typeof(lpLanguage)=="undefined"){lpLanguage="english"}if(typeof(lpAddVars)!="undefined"){lpAddVars("session","lpLanguage",lpLanguage)}lpMTagConfig.defaultInvite="chat-"+lpCountryCode+"-"+lpSegment+"-"+lpUnit+"-"+lpLanguage}catch(e){}lpMTagConfig.onLoadCode[lpMTagConfig.onLoadCode.length]=onloadEMT;lpMTagConfig.onLoadCode[lpMTagConfig.onLoadCode.length]=function(){if(typeof(lpMTagConfig.dynButton)!="undefined"){for(var a=0;a<lpMTagConfig.dynButton.length;a++){if(typeof(lpMTagConfig.dynButton[a].pid)!=="undefined"&&document.getElementById(lpMTagConfig.dynButton[a].pid)===null){lpMTagConfig.dynButton.splice(a,1);a--}}}};lpMTagConfig.onLoadAll=function(){lpMTagConfig.calculateSentPageTime();lpMTagConfig.lpLoadScripts()};lpMTagConfig.dynButton[lpMTagConfig.dynButton.length]={name:"chat-"+lpCountryCode+"-"+lpSegment+"-"+lpUnit+"-"+lpLanguage+"-1",pid:"lpButton1",afterStartPage:true};lpMTagConfig.dynButton[lpMTagConfig.dynButton.length]={name:"chat-"+lpCountryCode+"-"+lpSegment+"-"+lpUnit+"-"+lpLanguage+"-2",pid:"lpButton2",afterStartPage:true};lpMTagConfig.dynButton[lpMTagConfig.dynButton.length]={name:"chat-"+lpCountryCode+"-"+lpSegment+"-"+lpUnit+"-"+lpLanguage+"-3",pid:"lpButton3",afterStartPage:true};lpMTagConfig.dynButton[lpMTagConfig.dynButton.length]={name:"chat-"+lpCountryCode+"-"+lpSegment+"-"+lpUnit+"-"+lpLanguage+"-4",pid:"lpButton4",afterStartPage:true};lpMTagConfig.dynButton[lpMTagConfig.dynButton.length]={name:"chat-"+lpCountryCode+"-"+lpSegment+"-"+lpUnit+"-"+lpLanguage+"-5",pid:"lpButton5",afterStartPage:true};if(typeof(lpMTagConfig.dynButton)!="undefined"){lpMTagConfig.dynButton[lpMTagConfig.dynButton.length]={name:"drawer-chat",pid:"ConciergeChat",afterStartPage:true,ovr:"lpMTagConfig.db1"};lpMTagConfig.dynButton[lpMTagConfig.dynButton.length]={name:"drawer-concierge-call",pid:"ConciergeHighTouchVoice",afterStartPage:true,ovr:"lpMTagConfig.db1"};lpMTagConfig.dynButton[lpMTagConfig.dynButton.length]={name:"drawer-lowtouch-call",pid:"ConciergeLowTouchVoice",afterStartPage:true,ovr:"lpMTagConfig.db1"};lpMTagConfig.dynButton[lpMTagConfig.dynButton.length]={name:"drawer-screencast",pid:"ConciergeScreencast",afterStartPage:true,ovr:"lpMTagConfig.db1"}}Package("apple.chat");Event.onLoad(function(){var f=window,a,b=f.chatConfig,d=Element.query,c=$("page")?$("page"):d(".page")?d(".page"):$("apple-header")&&$("apple-header").parentElement?$("apple-header").parentElement:null;if(c&&c.id&&coherent.View.viewLookup[c.id]){c=Element.queryAll(".chat").length===1?d(".chat").parentElement:d(".masthead")&&!d(".chat:not(.masthead .chat)")?d(".masthead"):d(".guide-footer")?d(".guide-footer"):null;if(c&&c.id&&coherent.View.viewLookup[c.id]){c=c.parentElement?c.parentElement:null}}if(b&&d(".chat")){if(b.chat&&f.chatButtonConfig&&c){a=new apple.chat.ChatViewController(c)}else{if(b.chat&&b.chat.lpServer){a=new apple.chat.Chat();apple.chat.applyLPConfig(b.chat)}}}});apple.chat.ChatViewController=Class.create(coherent.View,{__structure__:{".cchat":coherent.Button({action:"cchatSelected"}),".htchat":coherent.Button({action:"htchatSelected"}),".cc2c":coherent.Button({action:"cc2cSelected"}),".htc2c":coherent.Button({action:"htc2cSelected"}),".httour":coherent.Button({action:"httourSelected"})},keyDependencies:{enableBtns:"configLoaded",createForm:"configLoaded",revealBtns:"chatType",revealDrawerToggler:"chatType",enableDrawerBtns:"drawerOpen",revealDrawer:"drawerOpen"},chatBtnMap:{cchat:"TextChat",htchat:"TextChat",cc2c:"Call",htc2c:"Call",httour:"ScreenCast"},init:function(){var g=Element,f=g.queryAll(".concierge-drawer .concierge-button"),a=g.queryAll("#chatlink"),j=this,c=Event.observe,d={};this.drawer=g.query(".concierge-drawer");this.drawerTogglerContainer=$("masthead-chat-view");this.drawerToggler=$("masthead-chat-button");this.ipsChatInvite=g.query(".guide-footer .invitation-to-chat");this.needhelp=$("needhelp");this.needhelpDrawer=$("needhelp_drawer");this.setValueForKey(false,"needhelpOpen");this.setValueForKey(false,"drawerOpen");this.btnIndex=1;if(this.drawer&&coherent.Browser.IE!==8){Element.addClassName(this.drawer,"opacity")}if(this.drawerToggler){c(this.drawerToggler,"click",this.drawerTogglerSelected.bind(this));c(this.drawerToggler,"onmouseout",this.onmouseleave.bind(this))}var i={owner:this,onmouseenter:this.onmouseenter,onmouseleave:this.onmouseleave};coherent.page.addTrackingInfo("concierge-drawer",i);if(f.length>0){f.forEach(function(k){c(k,"click",j.toggleDrawer.bind(j))})}this.jsonUrl=window.chatButtonConfig.availURL;this.onDemandChatType=window.chatButtonConfig.onDemandChatType;if(!this.onDemandChatType&&this.jsonUrl&&JSONRPC){this.jsonRequest=JSONRPC.get(this.jsonUrl,d);this.jsonRequest.addMethods(this.requestComplete.bind(this),this.requestFail.bind(this));this.requestTimeout.delay(15000)}Event.observe(document.body,"click",this.closeMenu.bindAsEventListener(this));Event.observe(document.body,"touchend",this.closeMenu.bindAsEventListener(this));if(a.length>0){a.forEach(function(k){c(k,"click",j.needhelpLinksClick.bindAsEventListener(j))})}if(this.needhelp){var h=$("u_chat"),b=$("u_tele");h.style.display="none";this.needhelp.setAttribute("aria-haspopup","true");this.needhelpParts={caslink:"Need help with a product you own?",orderstatuslink:"Need help with an order you placed?",chatlink:"Need help buying products you want?"};caslink.target="CAS"}},onclick:function(a){var b=this.getTargetElement(a);this.base(a);if(b){if(Element.hasClassName(b,"chat-ondemand")){this.onDemandBtnClick(b)}}},getTargetElement:function(f){var h=f.target||f.srcElement,d=h.parentNode,b=h.nodeName.toLowerCase(),a=d.nodeName.toLowerCase(),i=d.parentNode,c=i.nodeName.toLowerCase(),g;h=(b==="a"||b=="button"||b=="select")?h:null;d=(a==="a"||a=="button"||a=="select")?d:(c==="a"||c=="button"||c=="select")?i:null;g=h||d;return g},requestFail:function(a){a=a||"JSON load failure.";window.console.log(a+" ["+this.jsonUrl+"]")},requestTimeout:function(){try{this.jsonRequest.cancel()}catch(a){}},requestComplete:function(a){this.btnConfig=a.buttons;this.baseUrl=a.url;this.routingConfig=a.webChatRouting;this.urlMsg=a.urlMsg;if(this.btnConfig&&this.baseUrl&&this.routingConfig){this.setValueForKey(true,"configLoaded")}else{this.requestFail("Required properties not found in JSON.")}if(this.onDemandChatType){if(this.urlMsg){this.openOohWindow($(this.sender))}else{this.btnSelected($(this.sender),a.chatType,this.chatBtnMap[a.chatType])}}},createForm:function(){var m=document,o=this.routingConfig,h=window.chatConfig.chat.page,g,i,n,j="",c,l={WEB_CHAT_TYPE:"",WEB_CHAT_ROUTING_ID:"",WEB_CHAT_ORIGIN:"",WEB_CHAT_REFER_URL:encodeURI(m.referrer.split("#")[0]),WEB_CHAT_PAGE_URL:encodeURI(window.location.href.split("#")[0])},b=this.baseUrl,f,k=m.forms.chatform,d,a=null;if(this.configLoaded&&o&&h&&b&&(!m.forms.chatform||this.onDemandChatType)){l.WEB_CHAT_TOP_QS_CAT="";l.WEB_CHAT_NI_CHAT_MESSAGE="";l.WEB_CHAT_NI_CHAR_TIMER="";l.WEB_CHAT_TOP_QS="";l.WEB_CHAT_NI_CHAT="";for(n in h){if(h.hasOwnProperty(n)){g=h[n];l[g.name]=g.value}}for(i in o){if(o.hasOwnProperty(i)){l[i]=o[i]}}d=this.sender?$(this.sender).getAttribute("data-chat-ui"):null,a=d?d.split(";"):null;for(data in a){if(a.hasOwnProperty(data)){data=a[data].split("=");l[data[0]]=decodeURIComponent(data[1]||"")}}for(dataKey in o){if(o.hasOwnProperty(i)){l[i]=o[i]}}for(c in l){if(l.hasOwnProperty(c)){j+='<input type="hidden" id="'+c+'" name="'+c+'" value="'+l[c]+'" />'}}f=m.createElement("form");f.id="chatform";f.action=b;f.target="chatWin";f.method="post";f.innerHTML=j;k?k.remove():"";m.body.appendChild(f)}},enableBtns:function(){var b=this.btnConfig,a;if(!this.chatType){for(a in b){if(b.hasOwnProperty(a)&&b[a].status==="true"){this.setValueForKey(a,"chatType")}}}},revealBtns:function(){var c=Element,b=c.queryAll("."+this.chatType),a=this,d="lpButton";if(b.length>0&&this.chatType!==this.trackedType){b.forEach(function(f){c.addClassName(f,"chat-online");c.addClassName(f,"button-dynamic");a.addLink(f)});this.trackedType=this.chatType;a.subMenuElements=c.queryAll("#concierge-drawer a")}},addLink:function(a){var c=Element,d=a.firstElementChild?a.firstElementChild:a.firstChild&&a.firstChild.nodeType===1?a.firstChild:null,b=document.createElement("a");b.setAttribute("href","#");if(c.hasClassName(a,"concierge-button")&&!c.hasClassName(a,"handheld")){b.setAttribute("tabindex","-1")}if(d&&!c.query(a,"a")){if(d.nodeName==="DIV"&&d.className==="ui-button"){b.innerHTML=d.innerHTML;b.className="ui-button"}else{b.innerHTML=d.outerHTML}a.replaceChild(b,d)}},revealDrawerToggler:function(){var b=Element,a=b.queryAll(".concierge-button."+this.chatType);if(a.length>0&&this.drawerTogglerContainer&&this.drawerToggler&&!this.drawerTogglerDisplayed){b.addClassName(this.drawerTogglerContainer,"enabled");this.drawerToggler.setAttribute("aria-controls",this.drawer.id);this.drawerTogglerDisplayed=true}},toggleChatInvite:function(){var a=window;if(this.ipsChatInvite&&a.showInvitationToChat&&a.hideInvitationToChat){a.setTimeout(a.showInvitationToChat,30000);a.setTimeout(a.hideInvitationToChat,60000)}},trackBtn:function(c,b,g){var f=apple.metrics,d="Chat",a=g?(c+":"+g):c;if(f){f.fireMicroEvent({eVar:"prop41",feature:d,part:b,action:a});if(c==="Selected"){if(b.indexOf("AskNow")!==-1){b="AskNow"}f.fireMicroEvent({eVar:"eVar41",feature:d,action:b})}}},trackDrawerBtnDisplay:function(){var f=Element,c=f.queryAll(".concierge-button.chat-online"),a=this,b,d=f.hasClassName;if(this.drawerOpen&&!d(this.drawer,"open-drawer")&&c.length>0){c.forEach(function(g){b=d(g,"cchat")||d(g,"htchat")?"TextChat":d(g,"cc2c")||d(g,"htc2c")?"Call":"ScreenCast";a.trackBtn("Displayed",b+"-ht")})}},enableDrawerBtns:function(){var c=Element,a=this,d=c.query(".concierge-button.chat-learn-more a"),b=c.queryAll(".concierge-button.chat-online a");if(b.length>0){b.forEach(function(f){f.setAttribute("tabindex",a.drawerOpen&&!c.hasClassName(a.drawer,"open-drawer")?"0":"-1")})}if(d){d.setAttribute("tabindex",a.drawerOpen&&!c.hasClassName(a.drawer,"open-drawer")?"0":"-1")}},btnSelected:function(a,f,c){var b,g,i=document,d=Element,h=i.forms.chatform,j=window.chatButtonConfig.infoURL;if(this.urlMsg!==undefined){this.openOohWindow(d);return}if(d.hasClassName(a,"chat-online")||this.onDemandChatType){if(d.hasClassName(a,"concierge-button")){b=c+"-ht";g=""}else{b="AskNow-lt";g=a.getAttribute("data-tracking")}this.trackBtn("Selected",b,g);if(h&&f){h.WEB_CHAT_TYPE.value=f;h.WEB_CHAT_ROUTING_ID.value=this.btnConfig[f].WEB_CHAT_ROUTING_ID;h.WEB_CHAT_ORIGIN.value=a.getAttribute("data-tracking");h.WEB_CHAT_TOP_QS_CAT.value=this.btnConfig[f].WEB_CHAT_TOP_QS_CAT;h.WEB_CHAT_NI_CHAT_MESSAGE.value=this.btnConfig[f].WEB_CHAT_NI_CHAT_MESSAGE;h.WEB_CHAT_NI_CHAR_TIMER.value=this.btnConfig[f].WEB_CHAT_NI_CHAR_TIMER;h.WEB_CHAT_TOP_QS.value=this.btnConfig[f].WEB_CHAT_TOP_QS;h.WEB_CHAT_NI_CHAT.value=this.btnConfig[f].WEB_CHAT_NI_CHAT;if(j){this.requestInfoProps(j)}else{this.openChatWin(h)}}}},openChatWin:function(a){if(window.event){this.handlePreventDefault(window.event)}if(typeof(this.blankWindow)!="object"){this.blankWindow=window.open("#","chatWin","width=375,height=773,menubar=no,location=no,resizable=no,scrollbars=no,status=no");a.submit()}else{if(!this.blankWindow.closed){this.blankWindow.focus()}else{this.blankWindow=window.open("#","chatWin","width=375,height=773,menubar=no,location=no,resizable=no,scrollbars=no,status=no");a.submit()}}},requestInfoProps:function(b){var f,a=document.forms.chatform,g=function(h){h=h||"JSON load failure.";window.console.log(h+" ["+b+"]")},d=function(){try{f.cancel()}catch(h){}},c=function(j){var m,k="",l,i,h=j.clientInfo;for(m in h){if(h.hasOwnProperty(m)){l=h[m],i=a[m];if(i){i.value=l}else{k+='<input type="hidden" id="'+m+'" name="'+m+'" value="'+l+'" />'}}}if(k!==""){Element.innerHTML(a,k,true)}this.openChatWin(a)};if(b&&JSONRPC&&a){f=JSONRPC.get(b,"",{sync:true});f.addMethods(c.bind(this),g.bind(this));d.delay(15000)}},drawerTogglerSelected:function(b){if(this.__timer){window.clearTimeout(this.__timer);this.__timer=null}function a(){this.__timer=null;this.toggleDrawer();if(this.drawerOpen){this.trackBtn("Selected","AskNow-ht",this.drawerToggler.id)}}this.__timer=a.bindAndDelay(this,150);this.hoverNodeId=b.id},onmouseenter:function(a){this.hoverNodeId=a.id;if(this.__timer){window.clearTimeout(this.__timer);this.__timer=null}},onmouseleave:function(b){if(b.id!==this.hoverNodeId){return}if(this.__timer){window.clearTimeout(this.__timer);this.__timer=null}function a(){this.__timer=null;if(this.drawer&&this.drawerOpen){this.toggleDrawer()}}this.__timer=a.bindAndDelay(this,3000);this.hoverNodeId=""},cchatSelected:function(a){this.btnSelected($(a.id),"cchat","TextChat")},htchatSelected:function(a){this.btnSelected($(a.id),"htchat","TextChat")},cc2cSelected:function(a){this.btnSelected($(a.id),"cc2c","Call")},htc2cSelected:function(a){this.btnSelected($(a.id),"htc2c","Call")},httourSelected:function(a){this.btnSelected($(a.id),"httour","ScreenCast")},onDemandBtnClick:function(b){var c={},d=b.id?$(b.id).getAttribute("data-chat-avail"):b.getAttribute("data-chat-avail"),a=d?d.split(";"):null;this.sender=b.id?b.id:b;for(data in a){if(a.hasOwnProperty(data)){data=a[data].split("=");if(data[0].length>0){c[data[0]]=decodeURIComponent(data[1]||"")}}}this.jsonRequest=JSONRPC.get(this.jsonUrl,c,{sync:true});this.jsonRequest.addMethods(this.requestComplete.bind(this),this.requestFail.bind(this));this.requestTimeout.delay(15000)},toggleDrawer:function(){this.setValueForKey(this.drawerOpen?false:true,"drawerOpen")},revealDrawer:function(){var a=Element,b=a.query(this.viewElement(),".intro-message");if(this.drawer){if(this.drawerOpen){a.addClassName(this.drawer,"open-drawer");a.addClassName(this.drawerToggler,"on");this.drawer.setAttribute("aria-hidden","false");this.drawerToggler.setAttribute("aria-expanded","true");if(b&&b.style.display!=="block"){b.style.display="block"}}else{a.removeClassName(this.drawer,"open-drawer");a.removeClassName(this.drawerToggler,"on");this.drawer.setAttribute("aria-hidden","true");this.drawerToggler.setAttribute("aria-expanded","false")}}},keydown:function(a){var c=a.keyCode;var b=a.target||a.srcElement;if(c===Event.KEY_ESC&&this.drawer&&this.drawerOpen){this.handlePreventDefault(a);Element.query(".ui-button").focus();this.toggleDrawer()}if(c===Event.KEY_TAB&&this.drawer&&this.drawerOpen&&this.subMenuElements.length>0){if(!a.shiftKey&&b===this.subMenuElements[this.subMenuElements.length-1]){this.handlePreventDefault(a);this.subMenuElements[0].focus()}if(a.shiftKey&&b===this.subMenuElements[0]){this.handlePreventDefault(a);this.subMenuElements[this.subMenuElements.length-1].focus()}}if(c===Event.KEY_RETURN&&!this.drawerOpen&&this.subMenuElements.length>0){this.handlePreventDefault(a);this.toggleDrawer();this.subMenuElements[0].focus()}},closeMenu:function(a){var b=a.target||a.srcElement;if(this.drawer&&this.drawerOpen){do{if(b&&b.id==="concierge-drawer"||b.id==="masthead-chat-button"){return}b=b.parentNode}while(b&&b!==document.body);this.toggleDrawer()}},needhelpLinksClick:function(a){(a.preventDefault)?a.preventDefault():a.returnValue=false;var d=a.target||a.srcElement,c;if(d.tagName.toLowerCase()!="a"&&d.tagName.toLowerCase()!="button"){c=this.findParentTag(d,"a")?this.findParentTag(d,"a"):this.findParentTag(d,"button")}else{c=d}if(this.onDemandChatType){this.onDemandBtnClick(c)}else{if(c.id==="chatlink"){var b=this.needhelpParts.chatlink;if(b){this.fireMetrics(b)}var f=(this.urlMsg===undefined)?Element.queryAll("#u_chat ."+this.chatType)[0].click():this.openOohWindow(c)}else{a.stopPropagation();this.redirectUrl(c)}}},openOohWindow:function(a){var b=this.urlMsg;window.name="_parent";window.open(b,"chatWin","width=375,height=773,menubar=no,location=no,resizable=no,scrollbars=no,status=no")},fireMetrics:function(b){var d=apple.metrics,a=window.s.pageName,c="Just ask";if(!b){b=""}if(d){d.fireMicroEvent({eVar:"prop41",feature:c,action:b})}},redirectUrl:function(b){var a=b.getAttribute("id");elHref=b.getAttribute("href"),part="",windowName="",windowSpecs="";if(a=="caslink"){part=this.needhelpParts.caslink;if(part){this.fireMetrics(part)}window.open(elHref,"CAS")}else{if(a=="orderstatuslink"){part=this.needhelpParts.orderstatuslink;if(part){this.fireMetrics(part)}window.setTimeout(function(){window.location.href=elHref},150)}}},findParentTag:function(b,a){a=a.toLowerCase();do{b=b.parentNode;if(b.tagName&&b.tagName.toLowerCase()==a){return b}}while(b.parentNode);return null},handlePreventDefault:function(a){(a.preventDefault)?a.preventDefault():a.returnValue=false},nextElementSibling:function(a){do{a=a.nextSibling}while(a&&a.nodeType!==1);return a},prevElementSibling:function(a){do{a=a.previousSibling}while(a&&a.nodeType!==1);return a}});(function(o,r,s,y,t,B,i,l,q,k){if(!o||!r||!s||!y||!t||!B){throw new Error("Chat Module does not have required dependencies available")}var x=".chat-button",f=".chat",c="chat-standby",g="chat-online",v=/online/,a="lpButton",n=0,p=s.locateAncestor,m=s.addClassName,b=s.hasClassName,h=s.query,u=B.observe,w,A=t.create({constructor:function(F){var D=$("masthead-chat-button"),G=this.buttons=s.queryAll(f),E,C=G.length;this.maxButtonCount=F&&F.dynButton&&F.dynButton.length;w=F;for(E=0;E<C;E+=1){G[E]=d.create(G[E],this)}if(D){j.create()}},maxButtonCount:0,assignBtnID:function(F){var G=F&&F.el||null,H=s.queryAll(f+":not(.concierge-button)"),E,C=H.length,D,I;if(G){for(E=0;E<C;E+=1){I=H[E].el||H[E];if(I===F.el){D=E+=1;break}}}return D&&(D<=this.maxButtonCount)?a+D:false},reveal:function(){var E,C=this.buttons.length,D,F,G;for(E=0;E<C;E+=1){D=this.buttons[E];F=D.el;if(D.online){if(!this.drawerActive&&s.hasClassName(F,"concierge-button")){this.drawerActive=true;$("masthead-chat-view").style.display="inline"}D.online();G=D.buttonEl.id;if(!D.tracked&&G&&G.match("lpButton")){i.fireMicroEvent({eVar:"prop41",feature:"Chat",part:"AskNow",action:"Displayed:"+G});D.tracked=true}}}if(this.drawerActive&&!this.askNowBtnTrackingDone){apple.metrics.fireMicroEvent({eVar:"prop41",feature:"Chat",part:"AskNow",action:"Displayed:masthead-chat-button"});this.askNowBtnTrackingDone=true}return true}}),j=t.create({constructor:function(){this.observeChatDrawer()},observeChatDrawer:function(){var F=$("masthead-chat-button"),H=$("concierge-drawer"),G="open-drawer",I="on",E=s.queryAll(H,".chat-button"),C=E.length,D=this;u(F,"click",function(){var K,M,J;s.toggleClassName(H,G);s.toggleClassName(F,I);apple.fcs.setAcceptCookie();if(s.hasClassName(H,G)){var L=s.query(H,".intro-message");if(L&&L.style.display!=="block"){L.style.display="block"}apple.metrics.fireMicroEvent({eVar:"eVar41",feature:"Chat",action:"AskNow"});apple.metrics.fireMicroEvent({eVar:"prop41",feature:"Chat",part:"AskNow-ht",action:"Selected:"+F.id});for(K=0;K<C;K+=1){M=E[K];J=J=h(M,"a");if(s.hasClassName(J,"online")){D.fireMetricsOnActionBtnDisplay(M)}}}})},fireMetricsOnActionBtnDisplay:function(E){var C=E.id,D=(C==="ConciergeChat")?"TextChat":(C==="ConciergeLowTouchVoice"||C==="ConciergeHighTouchVoice")?"Call":"ScreenCast";apple.metrics.fireMicroEvent({eVar:"prop41",feature:"Chat",part:D+"-ht",action:"Displayed"})}}),d=t.create({constructor:function(D,C){this.el=D;this.manager=C;this.buttonEl=h(D,x);if(!this.buttonEl.id){this._setID()}if(this.shouldResizeAncestor()){this._setButtonBounds()}this.update();if(!this.ready){u(this.buttonEl,"DOMNodeInserted",this);this.pollID=l.setInterval(this.update.bind(this),250)}},el:null,manager:null,pollID:null,ready:false,online:false,updates:0,handleEvent:function(C){switch(C.type){case"DOMNodeInserted":B.stopObserving(this.buttonEl,"DOMNodeInserted",this);this.update();break;case"click":this._onClick();break;default:break}},standby:function(){if(this._hasButton()){m(this.el,c)}},reveal:function(E,D){if(!this.ready){return}var C=E||m;D&&D();this.online=function(){C(this.el,g,{only:["opacity"],curve:r.easing.easeInOut(500),callback:this.track.bind(this)})};this.accessibilityFix=function(){var L=this.buttonEl,K=L.parentNode,I=h(L,"a"),J=h(K,"span"),G=J.innerHTML,M=I.innerHTML,F=G+M,H;if(s.hasClassName(K,"concierge-button")){I.appendChild(J)}else{s.setInnerHTML(I,F)}if(s.hasClassName(K,"chat-resize")){s.setStyle(K,"overflow","visible")}H=I.getAttribute("onclick");if(typeof(H)!=="function"){I.setAttribute("onclick",H+"return false;")}else{I.onclick=function(){H();return false}}I.setAttribute("href","#");this.updates=1};if(this.manager){this.manager.reveal()}else{this.online()}},update:function(){var C=v.test(this.buttonEl.innerHTML),D=this;if(!this._hasButton()||!C){return false}if(!this.ready&&this.shouldResizeAncestor()){this._animateButtonBounds(function(){D._setButtonBounds({width:"auto",height:"auto"});D._markReady();D.update()})}else{this._markReady()}if(this.pollID){l.clearInterval(this.pollID)}this.reveal(y.addClassName,this.standby.bind(this));if(this.updates===0&&this.accessibilityFix){this.accessibilityFix()}return true},track:function(){var D=this.buttonEl,C=h(D,"a"),E;if(C&&D.id&&i){E=this;u(this.buttonEl,"click",function(F){E.handleEvent(F)})}},shouldResizeAncestor:function(){return b(this.el,"chat-resize")},_setButtonBounds:function(D){var C=this.el,E=D||s.getDimensions(C);this._bounds=E;s.setStyles(C,{width:E.width,height:E.height,overflow:"hidden"})},_animateButtonBounds:function(D){var C=this.el;C.style.cssText=" ";(function(){this.standby();var E=s.getDimensions(C);this._setButtonBounds(this._bounds);y.setStyles(C,{width:E.width,height:E.height},{duration:250,callback:D})}).bindAndDelay(this,0)},_setID:function(){var C=this.manager&&this.manager.assignBtnID(this);if(C){this.buttonEl.id=C}},_hasButton:function(){return this.buttonEl.firstChild&&this.buttonEl.firstChild.nodeType===1},_markReady:function(){this.ready=true},_onClick:function(){var E=this.el,D=this.buttonEl,F=D.id,C;apple.fcs.setAcceptCookie();if(s.hasClassName(E,"concierge-button")){C=(F==="ConciergeChat")?"TextChat":(F==="ConciergeLowTouchVoice"||F==="ConciergeHighTouchVoice")?"Call":"ScreenCast";s.removeClassName($("concierge-drawer"),"open-drawer");s.removeClassName($("masthead-chat-button"),"on");apple.metrics.fireMicroEvent({eVar:"eVar41",feature:"Chat",action:C+"-ht"});apple.metrics.fireMicroEvent({eVar:"prop41",feature:"Chat",part:C+"-ht",action:"Selected"})}else{i.fireMicroEvent({eVar:"eVar41",feature:"Chat",action:"AskNow"});i.fireMicroEvent({eVar:"prop41",feature:"Chat",part:"AskNow-lt",action:"Selected:"+F})}if(w.doEVar21Capture){i.fireMicroEvent({eVar:"eVar21",feature:"chat",action:"Selected:"+D.id})}}});d.create=function(D,C){return new d(D,C)};j.create=function(){return new j()};A.create=function(C,D){if(!C){return false}return new A(C,D)};function z(E){var D=l.lpAddVars||null,G,F,H,C;if(!D||!E){return false}for(G in E){if(E.hasOwnProperty(G)){switch(G){case"page":case"session":case"visitor":H=E[G];C=H.length;for(F=0;F<C;F+=1){D(G,H[F].name,H[F].value)}break;default:w[G]=E[G];break}}}w.onLoadAll&&w.onLoadAll();return true}o._ChatButton=d;o.create=function(C){return A.create(C||l.lpMTagConfig)};o.Chat=o.create;o.applyLPConfig=z})(apple.chat,coherent,Element,coherent.Animator,Class,Event,apple.metrics,window,document);